<div class="home-container">
    <header class="header">
        <h1>An√°lisis de Regresi√≥n M√∫ltiple</h1>
        <p>Sistema para c√°lculo de regresi√≥n lineal m√∫ltiple</p>
    </header>

    <main class="main-content">
        <!-- Controles principales -->
        <div class="controls">
            <button class="btn btn-primary" (click)="addEmptyRow()">
                + Agregar Fila
            </button>
            <button class="btn btn-secondary" (click)="clearAll()">
                üóëÔ∏è Limpiar Todo
            </button>
            <button class="btn btn-success" (click)="calculateRegression()"
                [disabled]="summary.count < 3 || isCalculating">
                {{ isCalculating ? 'Calculando...' : 'üìä Calcular Regresi√≥n' }}
            </button>
        </div>

        <!-- Tabla de datos -->
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Y (Dependiente)</th>
                        <th>X‚ÇÅ (Independiente 1)</th>
                        <th>X‚ÇÇ (Independiente 2)</th>
                        <th>X‚ÇÅ¬≤</th>
                        <th>X‚ÇÇ¬≤</th>
                        <th>X‚ÇÅ * X‚ÇÇ</th>
                        <th>X‚ÇÅ * Y</th>
                        <th>X‚ÇÇ * Y</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let point of displayedData; let i = index; trackBy: trackByFn">
                        <td>{{ i + 1 }}</td>
                        <td>
                            <input type="number" [(ngModel)]="dataPoints[i].y" (input)="onDataChange()" placeholder="Y"
                                class="data-input">
                        </td>
                        <td>
                            <input type="number" [(ngModel)]="dataPoints[i].x1" (input)="onDataChange()"
                                placeholder="X‚ÇÅ" class="data-input">
                        </td>
                        <td>
                            <input type="number" [(ngModel)]="dataPoints[i].x2" (input)="onDataChange()"
                                placeholder="X‚ÇÇ" class="data-input">
                        </td>
                        <td class="calculated">{{ point.x1Squared || '-' }}</td>
                        <td class="calculated">{{ point.x2Squared || '-' }}</td>
                        <td class="calculated">{{ point.x1x2 || '-' }}</td>
                        <td class="calculated">{{ point.x1y || '-' }}</td>
                        <td class="calculated">{{ point.x2y || '-' }}</td>
                        <td>
                            <button class="btn btn-danger btn-sm" (click)="removeRow(i)">
                                üóëÔ∏è
                            </button>
                        </td>
                    </tr>
                </tbody>
                <!-- Filas de sumatorias -->
                <tfoot>
                    <tr class="summary-row">
                        <td>Œ£</td>
                        <td>{{ summary.sumY || 0 }}</td>
                        <td>{{ summary.sumX1 || 0 }}</td>
                        <td>{{ summary.sumX2 || 0 }}</td>
                        <td>{{ summary.sumX1Squared || 0 }}</td>
                        <td>{{ summary.sumX2Squared || 0 }}</td>
                        <td>{{ summary.sumX1x2 || 0 }}</td>
                        <td>{{ summary.sumX1y || 0 }}</td>
                        <td>{{ summary.sumX2y || 0 }}</td>
                        <td></td>
                    </tr>
                    <tr class="count-row">
                        <td>n</td>
                        <td colspan="8">{{ summary.count || 0 }} filas v√°lidas</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- Informaci√≥n de validaci√≥n -->
        <div class="validation-info" *ngIf="summary.count < 3">
            <div class="alert alert-warning">
                ‚ö†Ô∏è Se necesitan al menos <strong>3 filas completas</strong> para calcular la regresi√≥n
            </div>
        </div>
    </main>

    <app-matrix-display *ngIf="showMatrixComponents" [matrixData]="matrixData" title="Sistema de Ecuaciones Normales">
    </app-matrix-display>

    <app-gauss-jordan-matrix *ngIf="showMatrixComponents" [matrixData]="matrixData"
        title="C√°lculo de Matriz Inversa - M√©todo de Gauss-Jordan">
    </app-gauss-jordan-matrix>

    <app-regression-results *ngIf="showResults && regressionResult" [dataPoints]="dataPoints"
        [regressionData]="regressionResult">
    </app-regression-results>

    <app-correlation-matrix *ngIf="showResults && regressionResult" [regressionData]="regressionResult">
    </app-correlation-matrix>

</div>